START!
Take key teacher in provided checkpoint dict
Pretrained weights found at /archive/bioinformatics/Jamieson_lab/shared/spatial-core/ky/Demo_Huang/08052023/training_on_4_A100/eval/training_374999/teacher_checkpoint.pth and loaded with msg: _IncompatibleKeys(missing_keys=['blocks.0.0.norm1.weight', 'blocks.0.0.norm1.bias', 'blocks.0.0.attn.qkv.weight', 'blocks.0.0.attn.qkv.bias', 'blocks.0.0.attn.proj.weight', 'blocks.0.0.attn.proj.bias', 'blocks.0.0.norm2.weight', 'blocks.0.0.norm2.bias', 'blocks.0.0.mlp.fc1.weight', 'blocks.0.0.mlp.fc1.bias', 'blocks.0.0.mlp.fc2.weight', 'blocks.0.0.mlp.fc2.bias', 'blocks.0.1.norm1.weight', 'blocks.0.1.norm1.bias', 'blocks.0.1.attn.qkv.weight', 'blocks.0.1.attn.qkv.bias', 'blocks.0.1.attn.proj.weight', 'blocks.0.1.attn.proj.bias', 'blocks.0.1.norm2.weight', 'blocks.0.1.norm2.bias', 'blocks.0.1.mlp.fc1.weight', 'blocks.0.1.mlp.fc1.bias', 'blocks.0.1.mlp.fc2.weight', 'blocks.0.1.mlp.fc2.bias', 'blocks.0.2.norm1.weight', 'blocks.0.2.norm1.bias', 'blocks.0.2.attn.qkv.weight', 'blocks.0.2.attn.qkv.bias', 'blocks.0.2.attn.proj.weight', 'blocks.0.2.attn.proj.bias', 'blocks.0.2.norm2.weight', 'blocks.0.2.norm2.bias', 'blocks.0.2.mlp.fc1.weight', 'blocks.0.2.mlp.fc1.bias', 'blocks.0.2.mlp.fc2.weight', 'blocks.0.2.mlp.fc2.bias', 'blocks.0.3.norm1.weight', 'blocks.0.3.norm1.bias', 'blocks.0.3.attn.qkv.weight', 'blocks.0.3.attn.qkv.bias', 'blocks.0.3.attn.proj.weight', 'blocks.0.3.attn.proj.bias', 'blocks.0.3.norm2.weight', 'blocks.0.3.norm2.bias', 'blocks.0.3.mlp.fc1.weight', 'blocks.0.3.mlp.fc1.bias', 'blocks.0.3.mlp.fc2.weight', 'blocks.0.3.mlp.fc2.bias', 'blocks.0.4.norm1.weight', 'blocks.0.4.norm1.bias', 'blocks.0.4.attn.qkv.weight', 'blocks.0.4.attn.qkv.bias', 'blocks.0.4.attn.proj.weight', 'blocks.0.4.attn.proj.bias', 'blocks.0.4.norm2.weight', 'blocks.0.4.norm2.bias', 'blocks.0.4.mlp.fc1.weight', 'blocks.0.4.mlp.fc1.bias', 'blocks.0.4.mlp.fc2.weight', 'blocks.0.4.mlp.fc2.bias', 'blocks.0.5.norm1.weight', 'blocks.0.5.norm1.bias', 'blocks.0.5.attn.qkv.weight', 'blocks.0.5.attn.qkv.bias', 'blocks.0.5.attn.proj.weight', 'blocks.0.5.attn.proj.bias', 'blocks.0.5.norm2.weight', 'blocks.0.5.norm2.bias', 'blocks.0.5.mlp.fc1.weight', 'blocks.0.5.mlp.fc1.bias', 'blocks.0.5.mlp.fc2.weight', 'blocks.0.5.mlp.fc2.bias', 'blocks.0.6.norm1.weight', 'blocks.0.6.norm1.bias', 'blocks.0.6.attn.qkv.weight', 'blocks.0.6.attn.qkv.bias', 'blocks.0.6.attn.proj.weight', 'blocks.0.6.attn.proj.bias', 'blocks.0.6.norm2.weight', 'blocks.0.6.norm2.bias', 'blocks.0.6.mlp.fc1.weight', 'blocks.0.6.mlp.fc1.bias', 'blocks.0.6.mlp.fc2.weight', 'blocks.0.6.mlp.fc2.bias', 'blocks.0.7.norm1.weight', 'blocks.0.7.norm1.bias', 'blocks.0.7.attn.qkv.weight', 'blocks.0.7.attn.qkv.bias', 'blocks.0.7.attn.proj.weight', 'blocks.0.7.attn.proj.bias', 'blocks.0.7.norm2.weight', 'blocks.0.7.norm2.bias', 'blocks.0.7.mlp.fc1.weight', 'blocks.0.7.mlp.fc1.bias', 'blocks.0.7.mlp.fc2.weight', 'blocks.0.7.mlp.fc2.bias', 'blocks.0.8.norm1.weight', 'blocks.0.8.norm1.bias', 'blocks.0.8.attn.qkv.weight', 'blocks.0.8.attn.qkv.bias', 'blocks.0.8.attn.proj.weight', 'blocks.0.8.attn.proj.bias', 'blocks.0.8.norm2.weight', 'blocks.0.8.norm2.bias', 'blocks.0.8.mlp.fc1.weight', 'blocks.0.8.mlp.fc1.bias', 'blocks.0.8.mlp.fc2.weight', 'blocks.0.8.mlp.fc2.bias', 'blocks.0.9.norm1.weight', 'blocks.0.9.norm1.bias', 'blocks.0.9.attn.qkv.weight', 'blocks.0.9.attn.qkv.bias', 'blocks.0.9.attn.proj.weight', 'blocks.0.9.attn.proj.bias', 'blocks.0.9.norm2.weight', 'blocks.0.9.norm2.bias', 'blocks.0.9.mlp.fc1.weight', 'blocks.0.9.mlp.fc1.bias', 'blocks.0.9.mlp.fc2.weight', 'blocks.0.9.mlp.fc2.bias', 'blocks.0.10.norm1.weight', 'blocks.0.10.norm1.bias', 'blocks.0.10.attn.qkv.weight', 'blocks.0.10.attn.qkv.bias', 'blocks.0.10.attn.proj.weight', 'blocks.0.10.attn.proj.bias', 'blocks.0.10.norm2.weight', 'blocks.0.10.norm2.bias', 'blocks.0.10.mlp.fc1.weight', 'blocks.0.10.mlp.fc1.bias', 'blocks.0.10.mlp.fc2.weight', 'blocks.0.10.mlp.fc2.bias', 'blocks.0.11.norm1.weight', 'blocks.0.11.norm1.bias', 'blocks.0.11.attn.qkv.weight', 'blocks.0.11.attn.qkv.bias', 'blocks.0.11.attn.proj.weight', 'blocks.0.11.attn.proj.bias', 'blocks.0.11.norm2.weight', 'blocks.0.11.norm2.bias', 'blocks.0.11.mlp.fc1.weight', 'blocks.0.11.mlp.fc1.bias', 'blocks.0.11.mlp.fc2.weight', 'blocks.0.11.mlp.fc2.bias'], unexpected_keys=['dino_head.mlp.0.weight', 'dino_head.mlp.0.bias', 'dino_head.mlp.2.weight', 'dino_head.mlp.2.bias', 'dino_head.mlp.4.weight', 'dino_head.mlp.4.bias', 'dino_head.last_layer.weight_g', 'dino_head.last_layer.weight_v', 'ibot_head.mlp.0.weight', 'ibot_head.mlp.0.bias', 'ibot_head.mlp.2.weight', 'ibot_head.mlp.2.bias', 'ibot_head.mlp.4.weight', 'ibot_head.mlp.4.bias', 'ibot_head.last_layer.weight_g', 'ibot_head.last_layer.weight_v', 'blocks.1.norm1.weight', 'blocks.1.norm1.bias', 'blocks.1.attn.qkv.weight', 'blocks.1.attn.qkv.bias', 'blocks.1.attn.proj.weight', 'blocks.1.attn.proj.bias', 'blocks.1.ls1.gamma', 'blocks.1.norm2.weight', 'blocks.1.norm2.bias', 'blocks.1.mlp.fc1.weight', 'blocks.1.mlp.fc1.bias', 'blocks.1.mlp.fc2.weight', 'blocks.1.mlp.fc2.bias', 'blocks.1.ls2.gamma', 'blocks.2.norm1.weight', 'blocks.2.norm1.bias', 'blocks.2.attn.qkv.weight', 'blocks.2.attn.qkv.bias', 'blocks.2.attn.proj.weight', 'blocks.2.attn.proj.bias', 'blocks.2.ls1.gamma', 'blocks.2.norm2.weight', 'blocks.2.norm2.bias', 'blocks.2.mlp.fc1.weight', 'blocks.2.mlp.fc1.bias', 'blocks.2.mlp.fc2.weight', 'blocks.2.mlp.fc2.bias', 'blocks.2.ls2.gamma', 'blocks.3.norm1.weight', 'blocks.3.norm1.bias', 'blocks.3.attn.qkv.weight', 'blocks.3.attn.qkv.bias', 'blocks.3.attn.proj.weight', 'blocks.3.attn.proj.bias', 'blocks.3.ls1.gamma', 'blocks.3.norm2.weight', 'blocks.3.norm2.bias', 'blocks.3.mlp.fc1.weight', 'blocks.3.mlp.fc1.bias', 'blocks.3.mlp.fc2.weight', 'blocks.3.mlp.fc2.bias', 'blocks.3.ls2.gamma', 'blocks.4.norm1.weight', 'blocks.4.norm1.bias', 'blocks.4.attn.qkv.weight', 'blocks.4.attn.qkv.bias', 'blocks.4.attn.proj.weight', 'blocks.4.attn.proj.bias', 'blocks.4.ls1.gamma', 'blocks.4.norm2.weight', 'blocks.4.norm2.bias', 'blocks.4.mlp.fc1.weight', 'blocks.4.mlp.fc1.bias', 'blocks.4.mlp.fc2.weight', 'blocks.4.mlp.fc2.bias', 'blocks.4.ls2.gamma', 'blocks.5.norm1.weight', 'blocks.5.norm1.bias', 'blocks.5.attn.qkv.weight', 'blocks.5.attn.qkv.bias', 'blocks.5.attn.proj.weight', 'blocks.5.attn.proj.bias', 'blocks.5.ls1.gamma', 'blocks.5.norm2.weight', 'blocks.5.norm2.bias', 'blocks.5.mlp.fc1.weight', 'blocks.5.mlp.fc1.bias', 'blocks.5.mlp.fc2.weight', 'blocks.5.mlp.fc2.bias', 'blocks.5.ls2.gamma', 'blocks.6.norm1.weight', 'blocks.6.norm1.bias', 'blocks.6.attn.qkv.weight', 'blocks.6.attn.qkv.bias', 'blocks.6.attn.proj.weight', 'blocks.6.attn.proj.bias', 'blocks.6.ls1.gamma', 'blocks.6.norm2.weight', 'blocks.6.norm2.bias', 'blocks.6.mlp.fc1.weight', 'blocks.6.mlp.fc1.bias', 'blocks.6.mlp.fc2.weight', 'blocks.6.mlp.fc2.bias', 'blocks.6.ls2.gamma', 'blocks.7.norm1.weight', 'blocks.7.norm1.bias', 'blocks.7.attn.qkv.weight', 'blocks.7.attn.qkv.bias', 'blocks.7.attn.proj.weight', 'blocks.7.attn.proj.bias', 'blocks.7.ls1.gamma', 'blocks.7.norm2.weight', 'blocks.7.norm2.bias', 'blocks.7.mlp.fc1.weight', 'blocks.7.mlp.fc1.bias', 'blocks.7.mlp.fc2.weight', 'blocks.7.mlp.fc2.bias', 'blocks.7.ls2.gamma', 'blocks.8.norm1.weight', 'blocks.8.norm1.bias', 'blocks.8.attn.qkv.weight', 'blocks.8.attn.qkv.bias', 'blocks.8.attn.proj.weight', 'blocks.8.attn.proj.bias', 'blocks.8.ls1.gamma', 'blocks.8.norm2.weight', 'blocks.8.norm2.bias', 'blocks.8.mlp.fc1.weight', 'blocks.8.mlp.fc1.bias', 'blocks.8.mlp.fc2.weight', 'blocks.8.mlp.fc2.bias', 'blocks.8.ls2.gamma', 'blocks.9.norm1.weight', 'blocks.9.norm1.bias', 'blocks.9.attn.qkv.weight', 'blocks.9.attn.qkv.bias', 'blocks.9.attn.proj.weight', 'blocks.9.attn.proj.bias', 'blocks.9.ls1.gamma', 'blocks.9.norm2.weight', 'blocks.9.norm2.bias', 'blocks.9.mlp.fc1.weight', 'blocks.9.mlp.fc1.bias', 'blocks.9.mlp.fc2.weight', 'blocks.9.mlp.fc2.bias', 'blocks.9.ls2.gamma', 'blocks.10.norm1.weight', 'blocks.10.norm1.bias', 'blocks.10.attn.qkv.weight', 'blocks.10.attn.qkv.bias', 'blocks.10.attn.proj.weight', 'blocks.10.attn.proj.bias', 'blocks.10.ls1.gamma', 'blocks.10.norm2.weight', 'blocks.10.norm2.bias', 'blocks.10.mlp.fc1.weight', 'blocks.10.mlp.fc1.bias', 'blocks.10.mlp.fc2.weight', 'blocks.10.mlp.fc2.bias', 'blocks.10.ls2.gamma', 'blocks.11.norm1.weight', 'blocks.11.norm1.bias', 'blocks.11.attn.qkv.weight', 'blocks.11.attn.qkv.bias', 'blocks.11.attn.proj.weight', 'blocks.11.attn.proj.bias', 'blocks.11.ls1.gamma', 'blocks.11.norm2.weight', 'blocks.11.norm2.bias', 'blocks.11.mlp.fc1.weight', 'blocks.11.mlp.fc1.bias', 'blocks.11.mlp.fc2.weight', 'blocks.11.mlp.fc2.bias', 'blocks.11.ls2.gamma', 'blocks.0.norm1.weight', 'blocks.0.norm1.bias', 'blocks.0.attn.qkv.weight', 'blocks.0.attn.qkv.bias', 'blocks.0.attn.proj.weight', 'blocks.0.attn.proj.bias', 'blocks.0.ls1.gamma', 'blocks.0.norm2.weight', 'blocks.0.norm2.bias', 'blocks.0.mlp.fc1.weight', 'blocks.0.mlp.fc1.bias', 'blocks.0.mlp.fc2.weight', 'blocks.0.mlp.fc2.bias', 'blocks.0.ls2.gamma'])
weights shape torch.Size([768, 4, 14, 14])
Traceback (most recent call last):
  File "/endosome/work/bioinformatics/s217053/DINO/DINOv2/Spatial_Biology_Project-kate/examples/inference/example_08_run_dinov2_inference_tiff_only_batches.py", line 343, in <module>
    main()
  File "/endosome/work/bioinformatics/s217053/DINO/DINOv2/Spatial_Biology_Project-kate/examples/inference/example_08_run_dinov2_inference_tiff_only_batches.py", line 237, in main
    model.load_state_dict(model_state_dict, strict=False)
UnboundLocalError: local variable 'model_state_dict' referenced before assignment
